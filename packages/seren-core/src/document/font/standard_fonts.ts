/* Copyright 2015 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import { getLookupTableFactory } from "../../../../seren-common/src/utils/core_utils";
import { normalizeFontName } from "./fonts_utils";

/**
 * Hold a map of decoded fonts and of the standard fourteen Type1
 * fonts and their acronyms.
 */
const getStdFontMap = getLookupTableFactory(() => {
  // The standard 14 fonts:
  return {
    "Times-Roman": "Times-Roman" as const,
    "Helvetica": "Helvetica" as const,
    "Courier": "Courier" as const,
    "Symbol": "Symbol" as const,
    "Times-Bold": "Times-Bold" as const,
    "Helvetica-Bold": "Helvetica-Bold" as const,
    "Courier-Bold": "Courier-Bold" as const,
    "ZapfDingbats": "ZapfDingbats" as const,
    "Times-Italic": "Times-Italic" as const,
    "Helvetica-Oblique": "Helvetica-Oblique" as const,
    "Courier-Oblique": "Courier-Oblique" as const,
    "Times-BoldItalic": "Times-BoldItalic" as const,
    "Helvetica-BoldOblique": "Helvetica-BoldOblique" as const,
    "Courier-BoldOblique": "Courier-BoldOblique" as const,

    // Extra mappings
    "ArialNarrow": "Helvetica" as const,
    "ArialNarrow-Bold": "Helvetica-Bold" as const,
    "ArialNarrow-BoldItalic": "Helvetica-BoldOblique" as const,
    "ArialNarrow-Italic": "Helvetica-Oblique" as const,
    "ArialBlack": "Helvetica" as const,
    "ArialBlack-Bold": "Helvetica-Bold" as const,
    "ArialBlack-BoldItalic": "Helvetica-BoldOblique" as const,
    "ArialBlack-Italic": "Helvetica-Oblique" as const,
    "Arial-Black": "Helvetica" as const,
    "Arial-Black-Bold": "Helvetica-Bold" as const,
    "Arial-Black-BoldItalic": "Helvetica-BoldOblique" as const,
    "Arial-Black-Italic": "Helvetica-Oblique" as const,
    "Arial": "Helvetica" as const,
    "Arial-Bold": "Helvetica-Bold" as const,
    "Arial-BoldItalic": "Helvetica-BoldOblique" as const,
    "Arial-Italic": "Helvetica-Oblique" as const,
    "ArialMT": "Helvetica" as const,
    "Arial-BoldItalicMT": "Helvetica-BoldOblique" as const,
    "Arial-BoldMT": "Helvetica-Bold" as const,
    "Arial-ItalicMT": "Helvetica-Oblique" as const,
    "Arial-BoldItalicMT-BoldItalic": "Helvetica-BoldOblique" as const,
    "Arial-BoldMT-Bold": "Helvetica-Bold" as const,
    "Arial-ItalicMT-Italic": "Helvetica-Oblique" as const,
    "ArialUnicodeMS": "Helvetica" as const,
    "ArialUnicodeMS-Bold": "Helvetica-Bold" as const,
    "ArialUnicodeMS-BoldItalic": "Helvetica-BoldOblique" as const,
    "ArialUnicodeMS-Italic": "Helvetica-Oblique" as const,
    "Courier-BoldItalic": "Courier-BoldOblique" as const,
    "Courier-Italic": "Courier-Oblique" as const,
    "CourierNew": "Courier" as const,
    "CourierNew-Bold": "Courier-Bold" as const,
    "CourierNew-BoldItalic": "Courier-BoldOblique" as const,
    "CourierNew-Italic": "Courier-Oblique" as const,
    "CourierNewPS-BoldItalicMT": "Courier-BoldOblique" as const,
    "CourierNewPS-BoldMT": "Courier-Bold" as const,
    "CourierNewPS-ItalicMT": "Courier-Oblique" as const,
    "CourierNewPSMT": "Courier" as const,
    "Helvetica-BoldItalic": "Helvetica-BoldOblique" as const,
    "Helvetica-Italic": "Helvetica-Oblique" as const,
    "Symbol-Bold": "Symbol" as const,
    "Symbol-BoldItalic": "Symbol" as const,
    "Symbol-Italic": "Symbol" as const,
    "TimesNewRoman": "Times-Roman" as const,
    "TimesNewRoman-Bold": "Times-Bold" as const,
    "TimesNewRoman-BoldItalic": "Times-BoldItalic" as const,
    "TimesNewRoman-Italic": "Times-Italic" as const,
    "TimesNewRomanPS": "Times-Roman" as const,
    "TimesNewRomanPS-Bold": "Times-Bold" as const,
    "TimesNewRomanPS-BoldItalic": "Times-BoldItalic" as const,
    "TimesNewRomanPS-BoldItalicMT": "Times-BoldItalic" as const,
    "TimesNewRomanPS-BoldMT": "Times-Bold" as const,
    "TimesNewRomanPS-Italic": "Times-Italic" as const,
    "TimesNewRomanPS-ItalicMT": "Times-Italic" as const,
    "TimesNewRomanPSMT": "Times-Roman" as const,
    "TimesNewRomanPSMT-Bold": "Times-Bold" as const,
    "TimesNewRomanPSMT-BoldItalic": "Times-BoldItalic" as const,
    "TimesNewRomanPSMT-Italic": "Times-Italic" as const,
  }
});

// Contains mapping for standard fonts and xfa fonts.
const getFontNameToFileMap = getLookupTableFactory(() => {
  return {
    "Courier": "FoxitFixed.pfb" as const,
    "Courier-Bold": "FoxitFixedBold.pfb" as const,
    "Courier-BoldOblique": "FoxitFixedBoldItalic.pfb" as const,
    "Courier-Oblique": "FoxitFixedItalic.pfb" as const,
    "Helvetica": "LiberationSans-Regular.ttf" as const,
    "Helvetica-Bold": "LiberationSans-Bold.ttf" as const,
    "Helvetica-BoldOblique": "LiberationSans-BoldItalic.ttf" as const,
    "Helvetica-Oblique": "LiberationSans-Italic.ttf" as const,
    "Times-Roman": "FoxitSerif.pfb" as const,
    "Times-Bold": "FoxitSerifBold.pfb" as const,
    "Times-BoldItalic": "FoxitSerifBoldItalic.pfb" as const,
    "Times-Italic": "FoxitSerifItalic.pfb" as const,
    "Symbol": "FoxitSymbol.pfb" as const,
    "ZapfDingbats": "FoxitDingbats.pfb" as const,
    "LiberationSans-Regular": "LiberationSans-Regular.ttf" as const,
    "LiberationSans-Bold": "LiberationSans-Bold.ttf" as const,
    "LiberationSans-Italic": "LiberationSans-Italic.ttf" as const,
    "LiberationSans-BoldItalic": "LiberationSans-BoldItalic.ttf" as const,
  }
});

/**
 * Holds the map of the non-standard fonts that might be included as
 * a standard fonts without glyph data.
 */
const getNonStdFontMap = getLookupTableFactory(() => {
  return {
    "Calibri": "Helvetica" as const,
    "Calibri-Bold": "Helvetica-Bold" as const,
    "Calibri-BoldItalic": "Helvetica-BoldOblique" as const,
    "Calibri-Italic": "Helvetica-Oblique" as const,
    "CenturyGothic": "Helvetica" as const,
    "CenturyGothic-Bold": "Helvetica-Bold" as const,
    "CenturyGothic-BoldItalic": "Helvetica-BoldOblique" as const,
    "CenturyGothic-Italic": "Helvetica-Oblique" as const,
    "ComicSansMS": "Comic Sans MS" as const,
    "ComicSansMS-Bold": "Comic Sans MS-Bold" as const,
    "ComicSansMS-BoldItalic": "Comic Sans MS-BoldItalic" as const,
    "ComicSansMS-Italic": "Comic Sans MS-Italic" as const,
    "GillSansMT": "Helvetica" as const,
    "GillSansMT-Bold": "Helvetica-Bold" as const,
    "GillSansMT-BoldItalic": "Helvetica-BoldOblique" as const,
    "GillSansMT-Italic": "Helvetica-Oblique" as const,
    "Impact": "Helvetica" as const,
    "ItcSymbol-Bold": "Helvetica-Bold" as const,
    "ItcSymbol-BoldItalic": "Helvetica-BoldOblique" as const,
    "ItcSymbol-Book": "Helvetica" as const,
    "ItcSymbol-BookItalic": "Helvetica-Oblique" as const,
    "ItcSymbol-Medium": "Helvetica" as const,
    "ItcSymbol-MediumItalic": "Helvetica-Oblique" as const,
    "LucidaConsole": "Courier" as const,
    "LucidaConsole-Bold": "Courier-Bold" as const,
    "LucidaConsole-BoldItalic": "Courier-BoldOblique" as const,
    "LucidaConsole-Italic": "Courier-Oblique" as const,
    "LucidaSans-Demi": "Helvetica-Bold" as const,
    "MS-Gothic": "MS Gothic" as const,
    "MS-Gothic-Bold": "MS Gothic-Bold" as const,
    "MS-Gothic-BoldItalic": "MS Gothic-BoldItalic" as const,
    "MS-Gothic-Italic": "MS Gothic-Italic" as const,
    "MS-Mincho": "MS Mincho" as const,
    "MS-Mincho-Bold": "MS Mincho-Bold" as const,
    "MS-Mincho-BoldItalic": "MS Mincho-BoldItalic" as const,
    "MS-Mincho-Italic": "MS Mincho-Italic" as const,
    "MS-PGothic": "MS PGothic" as const,
    "MS-PGothic-Bold": "MS PGothic-Bold" as const,
    "MS-PGothic-BoldItalic": "MS PGothic-BoldItalic" as const,
    "MS-PGothic-Italic": "MS PGothic-Italic" as const,
    "MS-PMincho": "MS PMincho" as const,
    "MS-PMincho-Bold": "MS PMincho-Bold" as const,
    "MS-PMincho-BoldItalic": "MS PMincho-BoldItalic" as const,
    "MS-PMincho-Italic": "MS PMincho-Italic" as const,
    "NuptialScript": "Times-Italic" as const,
    "SegoeUISymbol": "Helvetica" as const,
  }
});

const getSerifFonts = getLookupTableFactory(() => {
  return {
    "Adobe Jenson": true as const,
    "Adobe Text": true as const,
    "Albertus": true as const,
    "Aldus": true as const,
    "Alexandria": true as const,
    "Algerian": true as const,
    "American Typewriter": true as const,
    "Antiqua": true as const,
    "Apex": true as const,
    "Arno": true as const,
    "Aster": true as const,
    "Aurora": true as const,
    "Baskerville": true as const,
    "Bell": true as const,
    "Bembo": true as const,
    "Bembo Schoolbook": true as const,
    "Benguiat": true as const,
    "Berkeley Old Style": true as const,
    "Bernhard Modern": true as const,
    "Berthold City": true as const,
    "Bodoni": true as const,
    "Bauer Bodoni": true as const,
    "Book Antiqua": true as const,
    "Bookman": true as const,
    "Bordeaux Roman": true as const,
    "Californian FB": true as const,
    "Calisto": true as const,
    "Calvert": true as const,
    "Capitals": true as const,
    "Cambria": true as const,
    "Cartier": true as const,
    "Caslon": true as const,
    "Catull": true as const,
    "Centaur": true as const,
    "Century Old Style": true as const,
    "Century Schoolbook": true as const,
    "Chaparral": true as const,
    "Charis SIL": true as const,
    "Cheltenham": true as const,
    "Cholla Slab": true as const,
    "Clarendon": true as const,
    "Clearface": true as const,
    "Cochin": true as const,
    "Colonna": true as const,
    "Computer Modern": true as const,
    "Concrete Roman": true as const,
    "Constantia": true as const,
    "Cooper Black": true as const,
    "Corona": true as const,
    "Ecotype": true as const,
    "Egyptienne": true as const,
    "Elephant": true as const,
    "Excelsior": true as const,
    "Fairfield": true as const,
    "FF Scala": true as const,
    "Folkard": true as const,
    "Footlight": true as const,
    "FreeSerif": true as const,
    "Friz Quadrata": true as const,
    "Garamond": true as const,
    "Gentium": true as const,
    "Georgia": true as const,
    "Gloucester": true as const,
    "Goudy Old Style": true as const,
    "Goudy Schoolbook": true as const,
    "Goudy Pro Font": true as const,
    "Granjon": true as const,
    "Guardian Egyptian": true as const,
    "Heather": true as const,
    "Hercules": true as const,
    "High Tower Text": true as const,
    "Hiroshige": true as const,
    "Hoefler Text": true as const,
    "Humana Serif": true as const,
    "Imprint": true as const,
    "Ionic No. 5": true as const,
    "Janson": true as const,
    "Joanna": true as const,
    "Korinna": true as const,
    "Lexicon": true as const,
    "LiberationSerif": true as const,
    "Liberation Serif": true as const,
    "Linux Libertine": true as const,
    "Literaturnaya": true as const,
    "Lucida": true as const,
    "Lucida Bright": true as const,
    "Melior": true as const,
    "Memphis": true as const,
    "Miller": true as const,
    "Minion": true as const,
    "Modern": true as const,
    "Mona Lisa": true as const,
    "Mrs Eaves": true as const,
    "MS Serif": true as const,
    "Museo Slab": true as const,
    "New York": true as const,
    "Nimbus Roman": true as const,
    "NPS Rawlinson Roadway": true as const,
    "NuptialScript": true as const,
    "Palatino": true as const,
    "Perpetua": true as const,
    "Plantin": true as const,
    "Plantin Schoolbook": true as const,
    "Playbill": true as const,
    "Poor Richard": true as const,
    "Rawlinson Roadway": true as const,
    "Renault": true as const,
    "Requiem": true as const,
    "Rockwell": true as const,
    "Roman": true as const,
    "Rotis Serif": true as const,
    "Sabon": true as const,
    "Scala": true as const,
    "Seagull": true as const,
    "Sistina": true as const,
    "Souvenir": true as const,
    "STIX": true as const,
    "Stone Informal": true as const,
    "Stone Serif": true as const,
    "Sylfaen": true as const,
    "Times": true as const,
    "Trajan": true as const,
    "Trinité": true as const,
    "Trump Mediaeval": true as const,
    "Utopia": true as const,
    "Vale Type": true as const,
    "Bitstream Vera": true as const,
    "Vera Serif": true as const,
    "Versailles": true as const,
    "Wanted": true as const,
    "Weiss": true as const,
    "Wide Latin": true as const,
    "Windsor": true as const,
    "XITS": true as const,
  }
});

const getSymbolsFonts = getLookupTableFactory(() => {
  return {
    "Dingbats": true as const,
    "Symbol": true as const,
    "ZapfDingbats": true as const,
    "Wingdings": true as const,
    "Wingdings-Bold": true as const,
    "Wingdings-Regular": true as const,
  }
});

// Glyph map for well-known standard fonts. Sometimes Ghostscript uses CID
// fonts, but does not embed the CID to GID mapping. The mapping is incomplete
// for all glyphs, but common for some set of the standard fonts.
const getGlyphMapForStandardFonts = getLookupTableFactory(() => {
  return {
    2: 10 as const,
    3: 32 as const,
    4: 33 as const,
    5: 34 as const,
    6: 35 as const,
    7: 36 as const,
    8: 37 as const,
    9: 38 as const,
    10: 39 as const,
    11: 40 as const,
    12: 41 as const,
    13: 42 as const,
    14: 43 as const,
    15: 44 as const,
    16: 45 as const,
    17: 46 as const,
    18: 47 as const,
    19: 48 as const,
    20: 49 as const,
    21: 50 as const,
    22: 51 as const,
    23: 52 as const,
    24: 53 as const,
    25: 54 as const,
    26: 55 as const,
    27: 56 as const,
    28: 57 as const,
    29: 58 as const,
    30: 894 as const,
    31: 60 as const,
    32: 61 as const,
    33: 62 as const,
    34: 63 as const,
    35: 64 as const,
    36: 65 as const,
    37: 66 as const,
    38: 67 as const,
    39: 68 as const,
    40: 69 as const,
    41: 70 as const,
    42: 71 as const,
    43: 72 as const,
    44: 73 as const,
    45: 74 as const,
    46: 75 as const,
    47: 76 as const,
    48: 77 as const,
    49: 78 as const,
    50: 79 as const,
    51: 80 as const,
    52: 81 as const,
    53: 82 as const,
    54: 83 as const,
    55: 84 as const,
    56: 85 as const,
    57: 86 as const,
    58: 87 as const,
    59: 88 as const,
    60: 89 as const,
    61: 90 as const,
    62: 91 as const,
    63: 92 as const,
    64: 93 as const,
    65: 94 as const,
    66: 95 as const,
    67: 96 as const,
    68: 97 as const,
    69: 98 as const,
    70: 99 as const,
    71: 100 as const,
    72: 101 as const,
    73: 102 as const,
    74: 103 as const,
    75: 104 as const,
    76: 105 as const,
    77: 106 as const,
    78: 107 as const,
    79: 108 as const,
    80: 109 as const,
    81: 110 as const,
    82: 111 as const,
    83: 112 as const,
    84: 113 as const,
    85: 114 as const,
    86: 115 as const,
    87: 116 as const,
    88: 117 as const,
    89: 118 as const,
    90: 119 as const,
    91: 120 as const,
    92: 121 as const,
    93: 122 as const,
    94: 123 as const,
    95: 124 as const,
    96: 125 as const,
    97: 126 as const,
    98: 196 as const,
    99: 197 as const,
    100: 199 as const,
    101: 201 as const,
    102: 209 as const,
    103: 214 as const,
    104: 220 as const,
    105: 225 as const,
    106: 224 as const,
    107: 226 as const,
    108: 228 as const,
    109: 227 as const,
    110: 229 as const,
    111: 231 as const,
    112: 233 as const,
    113: 232 as const,
    114: 234 as const,
    115: 235 as const,
    116: 237 as const,
    117: 236 as const,
    118: 238 as const,
    119: 239 as const,
    120: 241 as const,
    121: 243 as const,
    122: 242 as const,
    123: 244 as const,
    124: 246 as const,
    125: 245 as const,
    126: 250 as const,
    127: 249 as const,
    128: 251 as const,
    129: 252 as const,
    130: 8224 as const,
    131: 176 as const,
    132: 162 as const,
    133: 163 as const,
    134: 167 as const,
    135: 8226 as const,
    136: 182 as const,
    137: 223 as const,
    138: 174 as const,
    139: 169 as const,
    140: 8482 as const,
    141: 180 as const,
    142: 168 as const,
    143: 8800 as const,
    144: 198 as const,
    145: 216 as const,
    146: 8734 as const,
    147: 177 as const,
    148: 8804 as const,
    149: 8805 as const,
    150: 165 as const,
    151: 181 as const,
    152: 8706 as const,
    153: 8721 as const,
    154: 8719 as const,
    156: 8747 as const,
    157: 170 as const,
    158: 186 as const,
    159: 8486 as const,
    160: 230 as const,
    161: 248 as const,
    162: 191 as const,
    163: 161 as const,
    164: 172 as const,
    165: 8730 as const,
    166: 402 as const,
    167: 8776 as const,
    168: 8710 as const,
    169: 171 as const,
    170: 187 as const,
    171: 8230 as const,
    179: 8220 as const,
    180: 8221 as const,
    181: 8216 as const,
    182: 8217 as const,
    200: 193 as const,
    203: 205 as const,
    207: 211 as const,
    210: 218 as const,
    223: 711 as const,
    224: 321 as const,
    225: 322 as const,
    226: 352 as const,
    227: 353 as const,
    228: 381 as const,
    229: 382 as const,
    233: 221 as const,
    234: 253 as const,
    252: 263 as const,
    253: 268 as const,
    254: 269 as const,
    258: 258 as const,
    260: 260 as const,
    261: 261 as const,
    265: 280 as const,
    266: 281 as const,
    267: 282 as const,
    268: 283 as const,
    269: 313 as const,
    275: 323 as const,
    276: 324 as const,
    278: 328 as const,
    283: 344 as const,
    284: 345 as const,
    285: 346 as const,
    286: 347 as const,
    292: 367 as const,
    295: 377 as const,
    296: 378 as const,
    298: 380 as const,
    305: 963 as const,
    306: 964 as const,
    307: 966 as const,
    308: 8215 as const,
    309: 8252 as const,
    310: 8319 as const,
    311: 8359 as const,
    312: 8592 as const,
    313: 8593 as const,
    337: 9552 as const,
    493: 1039 as const,
    494: 1040 as const,
    672: 1488 as const,
    673: 1489 as const,
    674: 1490 as const,
    675: 1491 as const,
    676: 1492 as const,
    677: 1493 as const,
    678: 1494 as const,
    679: 1495 as const,
    680: 1496 as const,
    681: 1497 as const,
    682: 1498 as const,
    683: 1499 as const,
    684: 1500 as const,
    685: 1501 as const,
    686: 1502 as const,
    687: 1503 as const,
    688: 1504 as const,
    689: 1505 as const,
    690: 1506 as const,
    691: 1507 as const,
    692: 1508 as const,
    693: 1509 as const,
    694: 1510 as const,
    695: 1511 as const,
    696: 1512 as const,
    697: 1513 as const,
    698: 1514 as const,
    705: 1524 as const,
    706: 8362 as const,
    710: 64288 as const,
    711: 64298 as const,
    759: 1617 as const,
    761: 1776 as const,
    763: 1778 as const,
    775: 1652 as const,
    777: 1764 as const,
    778: 1780 as const,
    779: 1781 as const,
    780: 1782 as const,
    782: 771 as const,
    783: 64726 as const,
    786: 8363 as const,
    788: 8532 as const,
    790: 768 as const,
    791: 769 as const,
    792: 768 as const,
    795: 803 as const,
    797: 64336 as const,
    798: 64337 as const,
    799: 64342 as const,
    800: 64343 as const,
    801: 64344 as const,
    802: 64345 as const,
    803: 64362 as const,
    804: 64363 as const,
    805: 64364 as const,
    2424: 7821 as const,
    2425: 7822 as const,
    2426: 7823 as const,
    2427: 7824 as const,
    2428: 7825 as const,
    2429: 7826 as const,
    2430: 7827 as const,
    2433: 7682 as const,
    2678: 8045 as const,
    2679: 8046 as const,
    2830: 1552 as const,
    2838: 686 as const,
    2840: 751 as const,
    2842: 753 as const,
    2843: 754 as const,
    2844: 755 as const,
    2846: 757 as const,
    2856: 767 as const,
    2857: 848 as const,
    2858: 849 as const,
    2862: 853 as const,
    2863: 854 as const,
    2864: 855 as const,
    2865: 861 as const,
    2866: 862 as const,
    2906: 7460 as const,
    2908: 7462 as const,
    2909: 7463 as const,
    2910: 7464 as const,
    2912: 7466 as const,
    2913: 7467 as const,
    2914: 7468 as const,
    2916: 7470 as const,
    2917: 7471 as const,
    2918: 7472 as const,
    2920: 7474 as const,
    2921: 7475 as const,
    2922: 7476 as const,
    2924: 7478 as const,
    2925: 7479 as const,
    2926: 7480 as const,
    2928: 7482 as const,
    2929: 7483 as const,
    2930: 7484 as const,
    2932: 7486 as const,
    2933: 7487 as const,
    2934: 7488 as const,
    2936: 7490 as const,
    2937: 7491 as const,
    2938: 7492 as const,
    2940: 7494 as const,
    2941: 7495 as const,
    2942: 7496 as const,
    2944: 7498 as const,
    2946: 7500 as const,
    2948: 7502 as const,
    2950: 7504 as const,
    2951: 7505 as const,
    2952: 7506 as const,
    2954: 7508 as const,
    2955: 7509 as const,
    2956: 7510 as const,
    2958: 7512 as const,
    2959: 7513 as const,
    2960: 7514 as const,
    2962: 7516 as const,
    2963: 7517 as const,
    2964: 7518 as const,
    2966: 7520 as const,
    2967: 7521 as const,
    2968: 7522 as const,
    2970: 7524 as const,
    2971: 7525 as const,
    2972: 7526 as const,
    2974: 7528 as const,
    2975: 7529 as const,
    2976: 7530 as const,
    2978: 1537 as const,
    2979: 1538 as const,
    2980: 1539 as const,
    2982: 1549 as const,
    2983: 1551 as const,
    2984: 1552 as const,
    2986: 1554 as const,
    2987: 1555 as const,
    2988: 1556 as const,
    2990: 1623 as const,
    2991: 1624 as const,
    2995: 1775 as const,
    2999: 1791 as const,
    3002: 64290 as const,
    3003: 64291 as const,
    3004: 64292 as const,
    3006: 64294 as const,
    3007: 64295 as const,
    3008: 64296 as const,
    3011: 1900 as const,
    3014: 8223 as const,
    3015: 8244 as const,
    3017: 7532 as const,
    3018: 7533 as const,
    3019: 7534 as const,
    3075: 7590 as const,
    3076: 7591 as const,
    3079: 7594 as const,
    3080: 7595 as const,
    3083: 7598 as const,
    3084: 7599 as const,
    3087: 7602 as const,
    3088: 7603 as const,
    3091: 7606 as const,
    3092: 7607 as const,
    3095: 7610 as const,
    3096: 7611 as const,
    3099: 7614 as const,
    3100: 7615 as const,
    3103: 7618 as const,
    3104: 7619 as const,
    3107: 8337 as const,
    3108: 8338 as const,
    3116: 1884 as const,
    3119: 1885 as const,
    3120: 1885 as const,
    3123: 1886 as const,
    3124: 1886 as const,
    3127: 1887 as const,
    3128: 1887 as const,
    3131: 1888 as const,
    3132: 1888 as const,
    3135: 1889 as const,
    3136: 1889 as const,
    3139: 1890 as const,
    3140: 1890 as const,
    3143: 1891 as const,
    3144: 1891 as const,
    3147: 1892 as const,
    3148: 1892 as const,
    3153: 580 as const,
    3154: 581 as const,
    3157: 584 as const,
    3158: 585 as const,
    3161: 588 as const,
    3162: 589 as const,
    3165: 891 as const,
    3166: 892 as const,
    3169: 1274 as const,
    3170: 1275 as const,
    3173: 1278 as const,
    3174: 1279 as const,
    3181: 7622 as const,
    3182: 7623 as const,
    3282: 11799 as const,
    3316: 578 as const,
    3379: 42785 as const,
    3393: 1159 as const,
    3416: 8377 as const,
  }
});

// The glyph map for ArialBlack differs slightly from the glyph map used for
// other well-known standard fonts. Hence we use this (incomplete) CID to GID
// mapping to adjust the glyph map for non-embedded ArialBlack fonts.
const getSupplementalGlyphMapForArialBlack = getLookupTableFactory(() => {
  return {
    227: 322 as const,
    264: 261 as const,
    291: 346 as const,
  }
});

// The glyph map for Calibri (a Windows font) differs from the glyph map used
// in the standard fonts. Hence we use this (incomplete) CID to GID mapping to
// adjust the glyph map for non-embedded Calibri fonts.
const getSupplementalGlyphMapForCalibri = getLookupTableFactory(() => {
  return {
    1: 32 as const,
    4: 65 as const,
    5: 192 as const,
    6: 193 as const,
    9: 196 as const,
    17: 66 as const,
    18: 67 as const,
    21: 268 as const,
    24: 68 as const,
    28: 69 as const,
    29: 200 as const,
    30: 201 as const,
    32: 282 as const,
    38: 70 as const,
    39: 71 as const,
    44: 72 as const,
    47: 73 as const,
    48: 204 as const,
    49: 205 as const,
    58: 74 as const,
    60: 75 as const,
    62: 76 as const,
    68: 77 as const,
    69: 78 as const,
    75: 79 as const,
    76: 210 as const,
    80: 214 as const,
    87: 80 as const,
    89: 81 as const,
    90: 82 as const,
    92: 344 as const,
    94: 83 as const,
    97: 352 as const,
    100: 84 as const,
    104: 85 as const,
    109: 220 as const,
    115: 86 as const,
    116: 87 as const,
    121: 88 as const,
    122: 89 as const,
    124: 221 as const,
    127: 90 as const,
    129: 381 as const,
    258: 97 as const,
    259: 224 as const,
    260: 225 as const,
    263: 228 as const,
    268: 261 as const,
    271: 98 as const,
    272: 99 as const,
    273: 263 as const,
    275: 269 as const,
    282: 100 as const,
    286: 101 as const,
    287: 232 as const,
    288: 233 as const,
    290: 283 as const,
    295: 281 as const,
    296: 102 as const,
    336: 103 as const,
    346: 104 as const,
    349: 105 as const,
    350: 236 as const,
    351: 237 as const,
    361: 106 as const,
    364: 107 as const,
    367: 108 as const,
    371: 322 as const,
    373: 109 as const,
    374: 110 as const,
    381: 111 as const,
    382: 242 as const,
    383: 243 as const,
    386: 246 as const,
    393: 112 as const,
    395: 113 as const,
    396: 114 as const,
    398: 345 as const,
    400: 115 as const,
    401: 347 as const,
    403: 353 as const,
    410: 116 as const,
    437: 117 as const,
    442: 252 as const,
    448: 118 as const,
    449: 119 as const,
    454: 120 as const,
    455: 121 as const,
    457: 253 as const,
    460: 122 as const,
    462: 382 as const,
    463: 380 as const,
    853: 44 as const,
    855: 58 as const,
    856: 46 as const,
    876: 47 as const,
    878: 45 as const,
    882: 45 as const,
    894: 40 as const,
    895: 41 as const,
    896: 91 as const,
    897: 93 as const,
    923: 64 as const,
    1004: 48 as const,
    1005: 49 as const,
    1006: 50 as const,
    1007: 51 as const,
    1008: 52 as const,
    1009: 53 as const,
    1010: 54 as const,
    1011: 55 as const,
    1012: 56 as const,
    1013: 57 as const,
    1081: 37 as const,
    1085: 43 as const,
    1086: 45 as const,
  }
});

function getStandardFontName(name: string) {
  const fontName = normalizeFontName(name);
  const stdFontMap = getStdFontMap() as Record<string, string>;
  return stdFontMap[fontName];
}

function isKnownFontName(name: string) {
  const fontName = normalizeFontName(name);
  // 这里不是反复创建对象了吗？ 后面可能考虑要优化
  return !!(
    (<Record<string, string>>getStdFontMap())[fontName] ||
    (<Record<string, string>>getNonStdFontMap())[fontName] ||
    (<Record<string, boolean>>getSerifFonts())[fontName] ||
    (<Record<string, boolean>>getSymbolsFonts())[fontName]
  );
}

export {
  getFontNameToFileMap,
  getGlyphMapForStandardFonts,
  getNonStdFontMap,
  getSerifFonts,
  getStandardFontName,
  getStdFontMap,
  getSupplementalGlyphMapForArialBlack,
  getSupplementalGlyphMapForCalibri,
  getSymbolsFonts,
  isKnownFontName,
};
